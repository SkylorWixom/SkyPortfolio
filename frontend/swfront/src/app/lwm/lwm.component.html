<main class="page-wrapper">
  <!-- 1) Hero Banner: just like Home, static image + same text color size -->
  
  <div class="page-container learn-with-me">
    <section
      class="page-hero lwm-hero"
      style="background-image: url('/assets/images/circuitbackground.webp');"
    >
      <div class="hero-content">
        <h1>Learn with Me</h1>
        <p>Explore courses and modules on a variety of tech subjects.</p>
      </div>
    </section>
    <!-- 2) Intro section remains the same, with your “Multiple Subjects...” text -->
    <section class="lwm-section">
      <h2>Multiple Subjects, Endless Learning</h2>
      <p>
        As a lifelong learner, I'm always exploring new technologies.
        On the left, you can pick a subject like “Frontend” or “Backend,”
        then dive into its courses, modules, and final items on the right.
        Click on any “Final Item” to see more details, watch embedded videos,
        or read content in the modal.
      </p>
    </section>

    <!-- 3) Two-column layout, data-driven side nav + main content -->
    <section class="lwm-section lwm-layout">
      <!-- LEFT SIDEBAR: subjects from the DB -->
      <nav class="lwm-sidebar">
        <div class="subjects-list">
          <div class="subject-item" *ngFor="let subj of subjects">

            <div
              class="subject-header"
              [class.expanded]="subj.expanded"
              (click)="toggleSubject(subj)"
            >
              {{ subj.subjectTitle }}
              <span class="arrow">{{ subj.expanded ? '▼' : '▶' }}</span>
            </div>

            <ul class="courses-list" *ngIf="subj.expanded">
              <li
                *ngFor="let c of subj.courses"
                (click)="selectCourse(c); $event.stopPropagation()"
                [class.selected]="c === selectedCourse"
              >
                {{ c.courseTitle }}
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- RIGHT CONTENT: expanded course details, sections, modules, final items -->
      <article class="lwm-content">
        <ng-container *ngIf="selectedCourse; else noCourse">
          <h2>{{ selectedCourse.courseTitle }}</h2>

          <!-- For each section, build an accordion + tabs -->
          <div class="section-accordion" *ngFor="let sec of sectionsEx">
            <div class="section-header" (click)="toggleSection(sec)">
              <h4>{{ sec.sectionTitle }}</h4>
              <span class="accordion-arrow">{{ sec.expanded ? '▼' : '▶' }}</span>
            </div>

            <div class="section-body" *ngIf="sec.expanded">
              <nav class="tabs">
                <button
                  *ngFor="let mod of sec.modules"
                  [class.active]="sec.activeTab === mod.moduleTitle"
                  (click)="setActiveTab(sec, mod.moduleTitle); $event.stopPropagation()"
                >
                  {{ mod.moduleTitle }}
                </button>
              </nav>

              <div class="tab-content">
                <ng-container *ngFor="let mod of sec.modules">
                  <div *ngIf="sec.activeTab === mod.moduleTitle">
                    <ul class="final-items">
                      <li
                        *ngFor="let fi of mod.finalItems"
                        (click)="onFinalItemClick(fi); $event.stopPropagation()"
                      >
                        <strong>{{ fi.title }}</strong>
                        <small>{{ fi.content }}</small>
                      </li>
                    </ul>
                  </div>
                </ng-container>
              </div>
            </div>
          </div><!-- end sections loop -->

        </ng-container>
        <ng-template #noCourse>
          <p>Select a course on the left.</p>
        </ng-template>
      </article>
    </section>
  </div>
</main>

<!-- MODAL OVERLAY for final items -->
<div class="modal-overlay" *ngIf="isModalOpen">
  <div class="modal-container">
    <button class="close-btn" (click)="closeModal()">✕</button>
    <div *ngIf="selectedFinalItem">
      <h2>{{ selectedFinalItem.title }}</h2>
      <p *ngIf="selectedFinalItem.description">{{ selectedFinalItem.description }}</p>
      <p *ngIf="selectedFinalItem.content">{{ selectedFinalItem.content }}</p>
      <iframe
        width="560"
        height="315"
        *ngIf="selectedFinalItem.videoUrl"
        [src]="selectedFinalItem.videoUrl | safeUrl"
        frameborder="0"
        allowfullscreen
      ></iframe>
    </div>
  </div>
</div>
